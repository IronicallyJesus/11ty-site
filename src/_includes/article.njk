---
layout: "layout.njk"
---
<article>
    <h1 class='text-center'>{{ title }}</h1>
    <br/>
    {{ content | safe }}
</article>
<script src="/js/view-counter.js"></script>
<div id="bottom"></div>
<script>
    document.addEventListener('DOMContentLoaded', () => {
        // Define a unique slug for the home page
        const slug = '{{ page.fileSlug }}';
        
        // Use a flag in localStorage to prevent incrementing on every refresh
        const viewed = localStorage.getItem(`viewed-${slug}`);

        if (!viewed) {
            // We only need to send the update, not get the result
            fetch(`/api/views/${slug}`, { method: 'POST' })
                .then(response => {
                    if (response.ok) {
                        // Mark as viewed in this session if the update was successful
                        localStorage.setItem(`viewed-${slug}`, 'true');
                    }
                })
                .catch(error => {
                    console.error('Error updating home page view count:', error);
                });
        }
    });
</script>